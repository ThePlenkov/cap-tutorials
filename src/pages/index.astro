---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Search from '../components/Search.astro';
import TutorialCard from '../components/TutorialCard.astro';
import ThemeToggle from '../components/ThemeToggle.astro';
import { getCollection } from 'astro:content';

const allTutorials = await getCollection('tutorials', (entry) => 
  !entry.slug.includes('/')
);

console.log('All tutorials:', allTutorials.map(t => ({ 
  slug: t.slug,
  title: t.data.title,
  description: t.data.description,
  order: t.data.order
})));

const sortedTutorials = allTutorials.sort((a, b) => a.data.order - b.data.order);

console.log('Final sorted tutorials:', sortedTutorials.map(t => ({ 
  slug: t.slug,
  title: t.data.title,
  description: t.data.description,
  order: t.data.order
})));
---

<Layout title="Workshop Tutorials">
  <Header>
    <ThemeToggle />
  </Header>
  <main class="max-w-4xl mx-auto px-4 py-8">
    <Search />
    <div class="grid gap-6">
      {sortedTutorials.map((tutorial) => (
        <TutorialCard tutorial={tutorial} />
      ))}
    </div>
  </main>
</Layout>